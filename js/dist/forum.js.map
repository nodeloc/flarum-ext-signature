{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@gtdxyz/flarum-ext-signature/webpack/bootstrap","webpack://@gtdxyz/flarum-ext-signature/webpack/runtime/compat get default export","webpack://@gtdxyz/flarum-ext-signature/webpack/runtime/define property getters","webpack://@gtdxyz/flarum-ext-signature/webpack/runtime/hasOwnProperty shorthand","webpack://@gtdxyz/flarum-ext-signature/webpack/runtime/make namespace object","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['forum/app']\"","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['common/extend']\"","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@gtdxyz/flarum-ext-signature/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@gtdxyz/flarum-ext-signature/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['common/Component']\"","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['common/components/TextEditor']\"","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@gtdxyz/flarum-ext-signature/./src/forum/states/SignatureState.tsx","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@gtdxyz/flarum-ext-signature/./src/forum/components/Signature.tsx","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['common/extenders']\"","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['common/components/Button']\"","webpack://@gtdxyz/flarum-ext-signature/./src/forum/components/SignaturePage.tsx","webpack://@gtdxyz/flarum-ext-signature/external root \"flarum.core.compat['common/models/User']\"","webpack://@gtdxyz/flarum-ext-signature/./src/forum/extend.ts","webpack://@gtdxyz/flarum-ext-signature/./src/forum/index.ts","webpack://@gtdxyz/flarum-ext-signature/./src/forum/extendUserPage.tsx","webpack://@gtdxyz/flarum-ext-signature/./src/forum/extendCommentPost.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditor'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","import Stream from 'flarum/common/utils/Stream';\r\n\r\nclass SignatureState {\r\n  // The content of the signature\r\n  content: Stream<string>;\r\n\r\n  // Indicates whether the signature is being edited\r\n  editing: boolean;\r\n\r\n  constructor() {\r\n    this.content = Stream('');\r\n    this.editing = false;\r\n  }\r\n\r\n  // Sets the content of the signature\r\n  setContent(content: Stream<string>) {\r\n    this.content = content;\r\n  }\r\n\r\n  // Toggles the editing state\r\n  toggleEditing() {\r\n    this.editing = !this.editing;\r\n  }\r\n}\r\n\r\nexport default SignatureState;\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","import Component, { ComponentAttrs } from 'flarum/common/Component';\r\nimport User from 'flarum/common/models/User';\r\nimport app from 'flarum/forum/app';\r\nimport TextEditor from 'flarum/common/components/TextEditor';\r\nimport Button from 'flarum/common/components/Button';\r\nimport Stream from 'flarum/common/utils/Stream';\r\nimport SignatureState from '../states/SignatureState';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\nimport type Mithril from 'mithril';\r\n\r\ninterface SignatureAttrs extends ComponentAttrs {\r\n  user: User;\r\n  readonly?: boolean;\r\n  state?: SignatureState;\r\n}\r\n\r\nexport default class Signature extends Component<SignatureAttrs> {\r\n  signatureState!: SignatureState;\r\n  user!: User;\r\n  loading: boolean = false;\r\n\r\n  oninit(vnode: Mithril.Vnode<SignatureAttrs, this>) {\r\n    super.oninit(vnode);\r\n    this.user = vnode.attrs.user;\r\n    this.signatureState = this.attrs.state || new SignatureState();\r\n    this.signatureState.setContent(Stream(this.user.signature() || ''));\r\n  }\r\n\r\n  view() {\r\n    return (\r\n      <div className={`Signature ${this.signatureState.editing ? 'editing' : ''}`}>\r\n        {this.loading ? <LoadingIndicator /> : this.signatureState.editing ? this.renderEditor() : this.renderSignature()}\r\n      </div>\r\n    );\r\n  }\r\n  renderEditor() {\r\n    if (this.user.canEditSignature() && !this.attrs.readonly) {\r\n      return (\r\n        <div class=\"SignatureEditor\">\r\n          <TextEditor\r\n            value={this.signatureState.content()}\r\n            onchange={this.signatureState.content}\r\n            placeholder=\"Edit your signature here\"\r\n            composer={this.signatureState}\r\n            submitLabel={app.translator.trans('signature.forum.buttons.save')}\r\n            onsubmit={this.onEditorSubmit.bind(this)}\r\n          />\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  onEditorSubmit() {\r\n    this.save();\r\n  }\r\n\r\n  renderSignature() {\r\n    return (\r\n      <div className=\"Signature-content\" onclick={this.edit.bind(this)}>\r\n        {!this.user.signature() ? <p>{app.translator.trans('signature.forum.profile.click')}</p> : m.trust(this.user.signatureHtml())}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  edit() {\r\n    if (this.user.canEditSignature() && !this.attrs.readonly) {\r\n      this.signatureState.toggleEditing();\r\n      m.redraw();\r\n    }\r\n  }\r\n\r\n  save() {\r\n    const signature = this.signatureState.content();\r\n    this.loading = true;\r\n\r\n    this.user\r\n      .save({ signature })\r\n      .then(() => {\r\n        this.loading = false;\r\n        this.signatureState.setContent(Stream(signature));\r\n        this.signatureState.toggleEditing();\r\n        m.redraw();\r\n      })\r\n      .catch((error) => {\r\n        this.loading = false;\r\n        // Provide specific feedback to the user\r\n        console.error(error);\r\n        alert('Error saving signature'); // Replace with a more user-friendly error handling\r\n        m.redraw();\r\n      });\r\n  }\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import UserPage from 'flarum/forum/components/UserPage';\r\nimport type Mithril from 'mithril';\r\nimport Signature from './Signature';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport Button from 'flarum/common/components/Button';\r\nimport app from 'flarum/forum/app';\r\nimport SignatureState from '../states/SignatureState';\r\n\r\nexport default class SignaturePage extends UserPage {\r\n  signatureState!: SignatureState;\r\n\r\n  oninit(vnode: Mithril.Vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.loadUser(m.route.param('username'));\r\n\r\n    this.signatureState = new SignatureState();\r\n  }\r\n\r\n  content() {\r\n    return (\r\n      <div className=\"SignaturePage\">\r\n        <div className=\"SignaturePage-controls\">{this.controlItems().toArray()}</div>\r\n        <Signature user={this.user} state={this.signatureState} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  controlItems(): ItemList<Mithril.Children> {\r\n    const items = new ItemList<Mithril.Children>();\r\n\r\n    this.user?.canEditSignature() &&\r\n      items.add(\r\n        'edit',\r\n        <div className=\"SignaturePage-editControl\">\r\n          <Button className=\"Button\" icon=\"fas fa-edit\" onclick={() => this.onEdit()}>\r\n            {app.translator.trans('signature.forum.buttons.edit')}\r\n          </Button>\r\n          <label className=\"SignaturePage-editLabel\">\r\n            请注意，为避免过度占用版面，Size标签将不会解析，H1,H2标签也不会解析，其它标签正常使用。\r\n          </label>\r\n        </div>\r\n      );\r\n\r\n    return items;\r\n  }\r\n\r\n  onEdit() {\r\n    this.signatureState.toggleEditing();\r\n  }\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/User'];","import Extend from 'flarum/common/extenders';\r\nimport SignaturePage from './components/SignaturePage';\r\nimport User from 'flarum/common/models/User';\r\n\r\nexport default [\r\n  new Extend.Routes() //\r\n    .add('user.signature', '/u/:username/signature', SignaturePage),\r\n\r\n  new Extend.Model(User) //\r\n    .attribute<string>('signature')\r\n    .attribute<string>('signatureHtml')\r\n    .attribute<boolean>('canEditSignature')\r\n    .attribute<boolean>('canHaveSignature'),\r\n];\r\n","import app from 'flarum/forum/app';\r\nimport extendUserPage from './extendUserPage';\r\nimport extendCommentPost from './extendCommentPost';\r\n\r\nexport { default as extend } from './extend';\r\n\r\napp.initializers.add('gtdxyz-flarum-ext-signature', (app) => {\r\n  extendUserPage();\r\n  extendCommentPost();\r\n  \r\n});\r\n","import app from 'flarum/forum/app';\r\nimport { extend } from 'flarum/common/extend';\r\nimport type Mithril from 'mithril';\r\nimport UserPage from 'flarum/forum/components/UserPage';\r\nimport LinkButton from 'flarum/common/components/LinkButton';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\n\r\nexport default function extendUserPage() {\r\n  extend(UserPage.prototype, 'navItems', function (items: ItemList<Mithril.Children>) {\r\n    if ((this.user?.canHaveSignature() && this.user?.id() === app.session.user?.id()) || this.user?.canEditSignature()) {\r\n      items.add(\r\n        'signature',\r\n        <LinkButton\r\n          href={app.route('user.signature', { username: this.user?.slug() })}\r\n          icon=\"fas fa-signature\"\r\n        >\r\n          {app.translator.trans('signature.forum.buttons.signature')}\r\n        </LinkButton>,\r\n        20\r\n      );\r\n    }\r\n  });\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport { extend } from 'flarum/common/extend';\r\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\r\nimport CommentPost from 'flarum/forum/components/CommentPost';\r\nimport Signature from './components/Signature';\r\n\r\nexport default function extendCommentPost() {\r\n    extend(CommentPost.prototype, 'footerItems', function (items) {\r\n      if (app.current.matches(DiscussionPage)) {\r\n        if (this.attrs.post.user?.() && app.session.user) {\r\n          if (this.attrs.post.user().signature()) {\r\n            const allowInlineEditing = app.forum.attribute('allowInlineEditing') || false;\r\n\r\n            items.add(\r\n              'signature',\r\n              [\r\n                <Signature user={this.attrs.post.user()} readonly={!allowInlineEditing} />\r\n              ],\r\n              -999\r\n            );\r\n            // content.push(\r\n            //   <div className=\"Post-signature\">\r\n            //     <Signature user={this.attrs.post.user()} readonly={!allowInlineEditing} />\r\n            //   </div>\r\n            // );\r\n          }\r\n        }\r\n      }\r\n    });\r\n}\r\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","t","e","setPrototypeOf","bind","__proto__","_inheritsLoose","create","constructor","SignatureState","content","editing","this","Stream","_proto","setContent","toggleEditing","Signature","_Component","_this","_len","arguments","length","args","Array","_key","apply","concat","signatureState","user","loading","oninit","vnode","attrs","state","signature","view","m","className","LoadingIndicator","renderEditor","renderSignature","canEditSignature","readonly","class","TextEditor","onchange","placeholder","composer","submitLabel","app","trans","onsubmit","onEditorSubmit","save","onclick","edit","trust","signatureHtml","redraw","_this2","then","error","console","alert","Component","SignaturePage","_UserPage","loadUser","route","param","controlItems","toArray","_this$user","items","ItemList","add","Button","icon","onEdit","UserPage","Extend","User","attribute","extend","_this$user2","_app$session$user","_this$user3","_this$user4","canHaveSignature","id","LinkButton","href","username","slug","CommentPost","_this$attrs$post$user","_this$attrs$post","matches","DiscussionPage","post","allowInlineEditing"],"sourceRoot":""}